import unittest
import os
from NativeDB_py.合併音標比對excel結果 import 檢查不合格的表與字格

class 基本元素試驗(unittest.TestCase):
	def setUp(self):
		self.檔案所在 = os.path.join(os.path.dirname(__file__),'試驗資料')
	def tearDown(self):
		pass
	
	def test_比對_桌1(self):
		檔案 =  os.path.join(self.檔案所在 ,'numberbook1.xlsx')
		問題 = [(['toʔ8'], '1.7946093688657765', '2.02')]
		答案 = None
		結果 = 檢查不合格的表與字格(檔案, 問題)
		self.assertEqual(答案, 結果)
		
	def test_比對_記者交保以前(self):
		檔案 = os.path.join(self.檔案所在 ,'numberbook3.xlsx')
		問題 = [(['ki5', 'tsia3'], '1.7946093688657765', '2.02'), (['kau1', 'po3'], '4.38', '7.7')]
		self.assertRaises(RuntimeError, 檢查不合格的表與字格, 檔案, 問題)
	
	def test_比對_雞婆(self):
		檔案 = os.path.join(self.檔案所在 ,'numberbook4.xlsx')
		問題 = [(['ke1', 'po2'], '1.7946093688657765', '7.7')]
		self.assertRaises(RuntimeError, 檢查不合格的表與字格, 檔案, 問題)
		
	def test_比對_雙語_成功(self):
		檔案 = os.path.join(self.檔案所在 ,'Penang_DiT_M_M01_correct.xlsx')
		問題 = [(['keʔ9', ' piaʔ7'], '14.740574729819627', '15.075353933741027'),
					 (['hu2', ' kut7'], '18.77385414161029', '19.26625697137455'),
					 (['put7', ' si2'], '28.815642190509244', '29.271843682035016'),
					 (['kɔ1', ' so3'], '33.63810246089005', '34.11550322470964'),
					 (['taʔ9', ' pɔ5'], '44.99102428536262', '45.4476806663668'),
					 (['te6', ' tɔ2'], '49.295624723288405', '49.75721781203228'),
					 (['ko1', ' kip7'], '53.48328596126247', '53.845303513596484'),
					 (['keʔ7', ' paʔ7'], '64.3107333966327', '64.65126500530717'),
					 (['pueʔ9', ' ki1'], '68.44052622506138', '68.91486954446293'),
					 (['tsʰi4', ' ke5'], '73.38725533052218', '73.97269770352064'),
					 (['tui3', ' tsiʔ7'], '86.75663471321866', '87.1205208425927'),
					 (['pai2', ' tui6'], '90.63469725843467', '91.18589496350492'),
					 (['pɔ6', ' sɔ5'], '95.1412645046806', '95.63189831000534'),
					 (['tioʔ0', ' kip7'], '125.89746766003162', '126.21912104742034'),
					 (['to6', ' tik7'], '130.0072267379865', '130.33456116518144'),
					 (['pɔ3', ' sip8'], '133.77865877240194', '134.15179971737172'),
					 (['tsioʔ0', ' hut8'], '137.99877981185537', '138.4118052328583'),
					 (['to4', ' kɛ1'], '142.2470076170122', '142.71355864779437'),
					 (['po5', ' kɔk7'], '152.75715824731068', '153.11137793225308'),
					 (['peʔ0', ' peʔ8'], '156.85120370041216', '157.27561412352276')]
		答案 = None
		結果 = 檢查不合格的表與字格(檔案, 問題)
		self.assertEqual(答案, 結果)
	
	def test_比對_雙語_失敗(self):
		檔案 = os.path.join(self.檔案所在 ,'Penang_DiT_M_M01.xlsx')
		問題 = [(['keʔ9', ' piaʔ7'], '14.740574729819627', '15.075353933741027'),
					 (['hu2', ' kut7'], '18.77385414161029', '19.26625697137455'),
					 (['put7', ' si2'], '28.815642190509244', '29.271843682035016'),
					 (['kɔ1', ' so3'], '33.63810246089005', '34.11550322470964'),
					 (['taʔ9', ' pɔ5'], '44.99102428536262', '45.4476806663668'),
					 (['te6', ' tɔ2'], '49.295624723288405', '49.75721781203228'),
					 (['ko1', ' kip7'], '53.48328596126247', '53.845303513596484'),
					 (['keʔ7', ' paʔ7'], '64.3107333966327', '64.65126500530717'),
					 (['pueʔ9', ' ki1'], '68.44052622506138', '68.91486954446293'),
					 (['tsʰi4', ' ke5'], '73.38725533052218', '73.97269770352064'),
					 (['tui3', ' tsiʔ7'], '86.75663471321866', '87.1205208425927'),
					 (['pai2', ' tui6'], '90.63469725843467', '91.18589496350492'),
					 (['pɔ6', ' sɔ5'], '95.1412645046806', '95.63189831000534'),
					 (['tioʔ0', ' kip7'], '125.89746766003162', '126.21912104742034'),
					 (['to6', ' tik7'], '130.0072267379865', '130.33456116518144'),
					 (['pɔ3', ' sip8'], '133.77865877240194', '134.15179971737172'),
					 (['tsioʔ0', ' hut8'], '137.99877981185537', '138.4118052328583'),
					 (['to4', ' kɛ1'], '142.2470076170122', '142.71355864779437'),
					 (['po5', ' kɔk7'], '152.75715824731068', '153.11137793225308'),
					 (['peʔ0', ' peʔ8'], '156.85120370041216', '157.27561412352276'),
					 (['to6', ' kau5'], '161.3050550242606', '161.7620442092189'),
					 (['tiʔ9', ' hɔ6'], '165.45284019717852', '165.92391583197167'),
					 (['kɔ1', ' po2'], '169.54616681235345', '170.02319491007978'),
					 (['to6', ' ka1'], '174.13014740867982', '174.58554717965876'),
					 (['tui5', ' ku5'], '184.55278358485714', '185.02357704863195'),
					 (['be4', ' tsʰi5'], '188.9110828308377', '189.44525845626603'),
					 (['tui5', ' tik8'], '193.51239677342622', '193.90101030915488'),
					 (['pueʔ9', ' pai2'], '205.61684363195172', '206.12562424968297'),
					 (['pɔ5', ' si2'], '210.27336142701233', '210.83830651611444'),
					 (['te6', ' tsap8'], '214.77944444965354', '215.15598563300685'),
					 (['si2', ' kiɔk8'], '219.11430308561094', '219.64337340337062'),
					 (['huat7', ' kut8'], '233.76359947753613', '234.25650032442988'),
					 (['be4', ' tok8'], '239.9182572382746', '240.33955908222154'),
					 (['po3', ' hu6'], '244.9596979177678', '245.43301865727216'),
					 (['te6', ' si5'], '255.40950817318867', '256.01253233860274'),
					 (['pui2', ' tu1'], '260.4503542149177', '260.88912151481605'),
					 (['be4', ' tsua3'], '265.8163299661602', '266.4017110338467'),
					 (['tsiaʔ0', ' tse6'], '270.4529640420197', '271.0504964102799'),
					 (['peʔ0', ' tau6'], '279.563183316865', '280.08763150583616'),
					 (['sia7', ' ke5'], '288.00558294830546', '288.65504822028004'),
					 (['ku4', ' koŋ1'], '297.5583501732301', '298.03578887792474'),
					 (['kut8', ' to3'], '308.0850974151279', '308.5722942477209'),
					 (['ka5', ' sai3'], '337.7598312408766', '338.33862008449756'),
					 (['kuaʔ9', ' hue5'], '347.48640098869345', '348.0566193281041'),
					 (['si2', ' ki1'], '351.93086045992686', '352.51983094569226'),
					 (['paʔ9', ' kau3'], '356.6527244151442', '357.17030092830686'),
					 (['sit8', ' tue2'], '371.66191343466215', '372.2256327881944'),
					 (['to3', ' tai2'], '378.5753436758212', '379.1251285509606'),
					 (['go4', ' tsap8'], '383.28285509244273', '383.7033558872275'),
					 (['sit7', ' pue2'], '387.9676137987307', '388.5745937330376'),
					 (['tu1', ' tɔ6'], '393.17327268544545', '393.66799552332617'),
					 (['hau6', ' ko3'], '397.9437345052132', '398.53831553367763'),
					 (['ki2', ' to6'], '402.5951137535791', '403.1137821783606'),
					 (['tsiaʔ0', ' sɔ5'], '418.2366724657955', '418.86569743300333'),
					 (['po3', ' te6'], '466.79917446055043', '467.3652064760075'),
					 (['te2', ' pue1'], '471.0523865385348', '471.59027829357234'),
					 (['te6', ' kiu2'], '475.46315658286244', '475.92469827570034'),
					 (['siaʔ9', ' ʔioʔ8'], '479.771246644944', '480.28328864400066')
					 ]
		self.assertRaises(RuntimeError, 檢查不合格的表與字格, 檔案, 問題)

if __name__ == '__main__':
	unittest.main()
